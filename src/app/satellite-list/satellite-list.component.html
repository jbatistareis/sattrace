<div class="card">
  <div class="card-header">
    <form>
      <div class="row">
        <div class="col-10">
          <select class="custom-select custom-select-sm" name="category" [(ngModel)]="category" (change)="loadCategoryData(category)">
            <option [ngValue]="noCategory">No category</option>
            <option *ngFor="let item of categoryList" [ngValue]="item">{{item.name}}</option>
          </select>
        </div>
        <div class="col-2">
          <div class="dropdown">
            <button class="btn btn-secondary btn-sm dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <i class="fa fa-ellipsis-v"></i>
            </button>
            <div class="dropdown-menu">
              <a class="dropdown-item" data-toggle="modal" data-target="#categoryEditModal" (click)="newCategory()">New category</a>
              <a class="dropdown-item" data-toggle="modal" data-target="#categoryEditModal" [hidden]="category.id == 1">
                Edit category</a>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item">Export TLE data</a>
              <a class="dropdown-item">Import TLE data</a>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item" data-toggle="modal" data-target="#satelliteEditModal" (click)="newTle()">New TLE data</a>
            </div>
          </div>
        </div>
      </div>
    </form>
  </div>
  <ul class="list-group list-group-flush">
    <li class="list-group-item" *ngFor="let item of tleList">
      {{item.name}}
      <div class="btn-group btn-group-sm pull-right" role="group">
        <button type="button" class="btn btn-default btn-sm" data-toggle="modal" data-target="#satelliteEditModal" (click)="formTle = item"><i
            class="fa fa-edit"></i></button>
        <button type="button" class="btn btn-default btn-sm" (click)="toggleTle(item)"><i class="fa fa-eye"></i></button>
      </div>
    </li>
  </ul>
</div>

<!-- category modal -->
<div class="modal fade" id="categoryEditModal" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Category</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <form #catForm="ngForm" (ngSubmit)="saveCategory(catForm.form)">
        <div class="modal-body">
          <div class="form-group row">
            <label for="catName" class="col-sm-3 col-form-label">Name</label>
            <div class="col-sm-9">
              <input type="text" maxlength="20" id="catName" name="catName" #catName="ngModel" [(ngModel)]="formCategory.name" [class]="(catName.invalid && (catName.dirty || catName.touched)) ? 'form-control is-invalid' : 'form-control'"
                required>
            </div>
          </div>
          <div class="form-group row">
            <label for="description" class="col-sm-3 col-form-label">Description</label>
            <div class="col-sm-9">
              <textarea rows="3" maxlength="280" class="form-control unresizable" id="description" name="description" [(ngModel)]="formCategory.description"></textarea>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-primary" [disabled]="catForm.form.status === 'INVALID'"><i class="fa fa-save"></i>&nbsp;Save</button>
          <button type="button" class="btn btn-danger" [disabled]="(category.id === undefined) || (category.id === 1)" (click)="deleteCategory()">
            <i class="fa fa-trash"></i>&nbsp;Delete</button>
          <button type="button" class="btn btn-secondary" data-dismiss="modal"><i class="fa fa-times"></i>&nbsp;Close</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- satellite modal -->
<div class="modal fade" id="satelliteEditModal" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">TLE data</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <form #satForm="ngForm" (ngSubmit)="saveTle(satForm.form)">
        <div class="modal-body">
          <div class="form-group row">
            <label for="satName" class="col-sm-2 col-form-label">Name</label>
            <div class="col-sm-5">
              <input type="text" maxlength="24" id="satName" name="satName" #satName="ngModel" [(ngModel)]="formTle.name" [class]="(satName.invalid && (satName.dirty || satName.touched)) ? 'form-control is-invalid' : 'form-control'"
                required>
            </div>
          </div>
          <div class="form-group row">
            <label for="line1" class="col-sm-2 col-form-label">Line 1</label>
            <div class="col-sm-10">
              <input type="text" minlength="69" maxlength="69" id="line1" name="line1" #line1="ngModel" [(ngModel)]="formTle.line1" [class]="(line1.invalid && (line1.dirty || line1.touched)) ? 'form-control is-invalid' : 'form-control'"
                required>
            </div>
          </div>
          <div class="form-group row">
            <label for="line2" class="col-sm-2 col-form-label">Line 2</label>
            <div class="col-sm-10">
              <input type="text" minlength="69" maxlength="69" id="line2" name="line2" #line2="ngModel" [(ngModel)]="formTle.line2" [class]="(line2.invalid && (line2.dirty || line2.touched)) ? 'form-control is-invalid' : 'form-control'"
                required>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-primary" [disabled]="satForm.form.status === 'INVALID'"><i class="fa fa-save"></i>&nbsp;Save</button>
          <button type="button" class="btn btn-danger" [disabled]="formTle.id === undefined" (click)="deleteTle()"><i class="fa fa-trash"></i>&nbsp;Delete</button>
          <button type="button" class="btn btn-secondary" data-dismiss="modal"><i class="fa fa-times"></i>&nbsp;Close</button>
        </div>
      </form>
    </div>
  </div>
</div>